# Production Docker Compose - Server only (serves both API and static frontend)
# After pushing to GitHub, images will be available at ghcr.io/oliveagle/claudecodeui/*
services:
  server:
    image: ghcr.io/oliveagle/claudecodeui/ccui-server:latest
    container_name: ccui-server
    ports:
      - "7853:7853"
    environment:
      - PORT=7853
      - NODE_ENV=production
      - HOME=/workspace
      - ANTHROPIC_AUTH_TOKEN=${ANTHROPIC_AUTH_TOKEN}
      - ANTHROPIC_BASE_URL=${ANTHROPIC_BASE_URL}
      - ANTHROPIC_MODEL=${ANTHROPIC_MODEL:-GLM-4.7}
      - HTTP_PROXY=
      - HTTPS_PROXY=
      - http_proxy=
      - https_proxy=
    volumes:
      - server-data:/app/server/database
      - /mnt/volume3/data:/workspace
      - ~/.claude:/workspace/.claude
      - ~/.ssh/id_rsa:/workspace/.ssh/id_rsa:ro
      - ~/.ssh/id_rsa.pub:/workspace/.ssh/id_rsa.pub:ro
      - ~/.ssh/known_hosts:/workspace/.ssh/known_hosts
      - ~/.ssh/id_rsa:/root/.ssh/id_rsa:ro
      - ~/.ssh/id_rsa.pub:/root/.ssh/id_rsa.pub:ro
      - ~/.ssh/known_hosts:/root/.ssh/known_hosts:ro
      - ~/.gitconfig:/workspace/.gitconfig:ro
      - ~/.config/gh:/workspace/.config/gh
    restart: unless-stopped

volumes:
  server-data:
    driver: local
